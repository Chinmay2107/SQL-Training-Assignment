**Query**: Fetch the following columns for created orders. These should be sales orders.<br>
ORDER_ID<br>
TOTAL_AMOUNT<br>
PAYMENT_METHOD<br>
SHOPIFY_ORDER_NAME<br>
NOTE: <br>
The total amount represents the total amount of the order.<br>
The payment method is the method by which payment was made, like Cash, mastercard, visa, paypal, etc.<br>
<br>

**Solution**:<br>
**OLD APPROACH:** Becauls this query wonâ€™t include shipping charges(i.e the adjustments)<br>
SELECT oh.order_id, SUM(oi.quantity*oi.unit_price) AS total_amount, op.payment_method_type_id,<br> oid.order_identification_type_id AS shopify_order_name from order_header oh  <br>
JOIN <br>
order_item oi USING (order_id)  <br>
JOIN <br>
order_payment_preference op USING (order_id)  <br>
JOIN <br>
order_identification oid USING (order_id)  <br>
WHERE <br>
oh.order_type_id="SALES_ORDER" <br>
AND oid.order_identification_type_id="SHOPIFY_ORD_NAME" <br>
AND oh.status_id="ORDER_CREATED" GROUP BY oh.order_id;<br>
<br>
**CORRECTED APPROACH:**
SELECT oh.order_id, oh.grand_total AS total_amount, pmt.description, oid.order_identification_type_id AS <br>shopify_order_name from order_header oh  <br>
JOIN <br>
order_payment_preference op USING (order_id)   <br>
JOIN <br>
order_identification oid USING (order_id) <br>
JOIN <br>
Payment_Method_Type pmt USING (payment_method_type_id)   <br>
WHERE oh.order_type_id="SALES_ORDER" <br>
AND oid.order_identification_type_id="SHOPIFY_ORD_NAME" <br>
AND oh.status_id="ORDER_CREATED" <br>
GROUP BY oh.order_id;<br>


