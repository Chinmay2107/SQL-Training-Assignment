**Query**: Fetch the following columns for created orders. These should be sales orders.
ORDER_ID
TOTAL_AMOUNT
PAYMENT_METHOD
SHOPIFY_ORDER_NAME
NOTE: 
The total amount represents the total amount of the order.
The payment method is the method by which payment was made, like Cash, mastercard, visa, paypal, etc.


**Solution**:
**OLD APPROACH:** Becauls this query wonâ€™t include shipping charges(i.e the adjustments)
SELECT oh.order_id, SUM(oi.quantity*oi.unit_price) AS total_amount, op.payment_method_type_id, oid.order_identification_type_id AS shopify_order_name from order_header oh  
JOIN 
order_item oi USING (order_id)  
JOIN 
order_payment_preference op USING (order_id)  
JOIN 
order_identification oid USING (order_id)  
WHERE 
oh.order_type_id="SALES_ORDER" 
AND oid.order_identification_type_id="SHOPIFY_ORD_NAME" 
AND oh.status_id="ORDER_CREATED" GROUP BY oh.order_id;

**CORRECTED APPROACH:**
SELECT oh.order_id, oh.grand_total AS total_amount, pmt.description, oid.order_identification_type_id AS shopify_order_name from order_header oh  
JOIN 
order_payment_preference op USING (order_id)   
JOIN 
order_identification oid USING (order_id) 
JOIN 
Payment_Method_Type pmt USING (payment_method_type_id)   
WHERE oh.order_type_id="SALES_ORDER" 
AND oid.order_identification_type_id="SHOPIFY_ORD_NAME" 
AND oh.status_id="ORDER_CREATED" 
GROUP BY oh.order_id;


