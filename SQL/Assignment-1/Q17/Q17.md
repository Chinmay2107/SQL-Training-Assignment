**Query**: BOPIS orders Revenue in the last year:
Calculate the revenue generated from BOPIS orders over the past year.

**Solution**: 
**Considering Last year as the previous year a whole**
```sql
SELECT
	SUM(oi.UNIT_PRICE * oi.QUANTITY) AS BOPIS_Revenue
FROM
	order_header oh
JOIN order_item oi
on oh.order_id = oi.ORDER_ID 
JOIN order_item_ship_group_assoc oisga
ON oisga.ORDER_ID = oi.ORDER_ID AND oisga.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID
JOIN order_item_ship_group oisg
ON oisg.order_id = oisga.ORDER_ID AND oisg.SHIP_GROUP_SEQ_ID = oi.SHIP_GROUP_SEQ_ID 
WHERE
	oisg.SHIPMENT_METHOD_TYPE_ID = "STOREPICKUP"
	AND oh.ORDER_DATE >= DATE_SUB(DATE_SUB(curdate(),INTERVAL 1 YEAR)+interval 1 DAY,INTERVAL DAY(CURDATE()) DAY) and
	oh.ORDER_DATE <= DATE_SUB(CURDATE(),INTERVAL DAYOFYEAR(CURDATE()) DAY);
```
**Considering last 365 days as a year from now**
```sql
SELECT
	SUM(oi.UNIT_PRICE * oi.QUANTITY) AS BOPIS_Revenue
FROM
	order_header oh
JOIN order_item oi
on oh.order_id = oi.ORDER_ID 
JOIN order_item_ship_group_assoc oisga
ON oisga.ORDER_ID = oi.ORDER_ID AND oisga.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID
JOIN order_item_ship_group oisg
ON oisg.order_id = oisga.ORDER_ID AND oisg.SHIP_GROUP_SEQ_ID = oi.SHIP_GROUP_SEQ_ID 
WHERE
	oisg.SHIPMENT_METHOD_TYPE_ID = "STOREPICKUP"
	AND oh.ORDER_DATE >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND oh.ORDER_DATE <= CURDATE();
```
**Query Execution Plan**

| Type   | Cost  | Rows  |
|--------|-------|-------|
| select | 2,797.38 | 5,056 |

