**Query**: BOPIS orders Revenue in the last year:
Calculate the revenue generated from BOPIS orders over the past year.

**Solution**:
```sql
SELECT
	SUM(oi.UNIT_PRICE * oi.QUANTITY) AS BOPIS_Revenue
FROM
	order_header oh
JOIN order_item oi
		USING(order_id)
JOIN order_item_ship_group oisg
		USING(order_id)
WHERE
	oisg.SHIPMENT_METHOD_TYPE_ID = 'STOREPICKUP'
	AND oh.ORDER_DATE >= DATE_SUB(DATE_SUB(curdate(),INTERVAL 1 YEAR)+1,INTERVAL DAY(CURDATE()) DAY) and
	oh.ORDER_DATE <= DATE_SUB(CURDATE(),INTERVAL DAYOFYEAR(CURDATE()) DAY);
```
**Query Execution Plan**

| Type   | Cost  | Rows  |
|--------|-------|-------|
| select | 8,539.7 | 5,055 |

