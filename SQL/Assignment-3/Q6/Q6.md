**Query**: In the past month, which store has the highest number of one-day shipped orders?<br>

**Solution**:
```sql
SELECT
	f.FACILITY_ID,
	f.FACILITY_NAME,
	count(oisg.ORDER_ID)
FROM
	Order_Item_Ship_Group oisg
JOIN Facility f
		using (FACILITY_ID)
JOIN Order_Status os on
	os.ORDER_ID = oisg.ORDER_ID
WHERE
	os.STATUS_ID = "ITEM_COMPLETED"
	and DATEDIFF(CURDATE(), os.STATUS_DATETIME)<= 31
	and f.FACILITY_TYPE_ID in ("RETAIL_STORE", "OUTLET_STORE")
	and oisg.SHIPMENT_METHOD_TYPE_ID = "NEXT_DAY"
GROUP BY
	oisg.ORDER_ID;
```
**Query Execution Plan**

| Type | Cost     |   Rows |
| --- |----------| --- |
select | 81,979.05 | 28,206
