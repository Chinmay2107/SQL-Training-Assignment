**Query**: Leading up to the New Year, what is the count of orders shipped from stores in the 25 days preceding the New Year?<br>
<br>
**Solution**:
```sql
SELECT
	COUNT(distinct(oh.ORDER_ID)) as Total_Orders
FROM
	Order_Header oh
join order_item oi on
oi.ORDER_ID = oh.ORDER_ID
join order_item_ship_group_assoc oisga on
oisga.ORDER_ID = oi.ORDER_ID and oisga.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID 
join order_item_ship_group oisg on
oisg.ORDER_ID = oisga.ORDER_ID and oisga.SHIP_GROUP_SEQ_ID = oisg.SHIP_GROUP_SEQ_ID 
JOIN Facility f on
	oisg.facility_id = f.facility_id and f.facility_type_id in ("RETAIL_STORE", "OUTLET_STORE")
JOIN Order_Status os on
os.ORDER_ID = oh.ORDER_ID and oh.STATUS_ID = os.STATUS_ID AND  os.STATUS_DATETIME >= '2024-01-01' - INTERVAL 25 DAY AND os.STATUS_DATETIME < '2024-01-01'  and os.STATUS_ID = "ORDER_COMPLETED";
```
**Query Execution Plan**

| Type | Cost    |   Rows |
| --- |---------| --- |
select | 29,198.2 | 9,424
