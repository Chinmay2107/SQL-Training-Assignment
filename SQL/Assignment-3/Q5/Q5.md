**Query**: In New York, which product has the highest sales?<br>

**Solution**:
```sql
SELECT SUM(oi.quantity) as Total_Sales
FROM
	Order_Item oi 
JOIN
	Order_Header oh
		USING (ORDER_ID)
JOIN
	Order_Contact_Mech ocm
		USING (ORDER_ID)
JOIN Postal_Address pa
		using (CONTACT_MECH_ID)
WHERE
	pa.CITY = "New York"
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID = "SHIPPING_LOCATION" 
GROUP BY oi.PRODUCT_ID 
ORDER BY Total_Sales DESC 
LIMIT 1;

```
**Query Execution Plan**

| Type | Cost   |   Rows |
| --- |--------| --- |
select | 17,867.05 | 5,506
