**Query**: In New York, which product has the highest sales?<br>

**Solution**:
```sql
SELECT oi.PRODUCT_ID , SUM(oi.quantity) as Total_Sales
from Order_Item oi
JOIN
	Order_Header oh ON
oh.ORDER_ID = oi.ORDER_ID and oi.STATUS_ID = "ITEM_COMPLETED"
JOIN
	Order_Contact_Mech ocm
on ocm.ORDER_ID = oh.ORDER_ID 
JOIN Postal_Address pa
		using (CONTACT_MECH_ID)
WHERE
	pa.CITY = "New York"
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID = "SHIPPING_LOCATION" 
GROUP BY oi.PRODUCT_ID 
ORDER BY Total_Sales DESC 
LIMIT 1;

```
**Query Execution Plan**

| Type | Cost   |   Rows |
| --- |--------| --- |
select | 17,867.05 | 5,506
