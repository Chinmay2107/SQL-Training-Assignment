**Query**: How many single-item orders were fulfilled from warehouses in the last month?<br>
<br>
**Solution**
```sql
SELECT
    oi.ORDER_ID,
    COUNT(oi.order_item_seq_id) as total_count
FROM
    Order_Header oh
JOIN Order_Item oi
        using (ORDER_ID)
JOIN Order_Status os on
    os.ORDER_ID = oh.ORDER_ID
    and os.status_datetime <= CURDATE()
    and os.status_id = "ORDER_COMPLETED"
    and os.status_datetime >= DATE_SUB(CURDATE(), interval 1 month)
join order_item_ship_group_assoc oisga on
oisga.ORDER_ID = oi.ORDER_ID and oisga.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID 
join order_item_ship_group oisg on
oisg.ORDER_ID = oisga.ORDER_ID
JOIN Facility f on
    f.facility_id = oisg.facility_id and f.facility_type_id = 'WAREHOUSE'
GROUP BY
    oh.ORDER_ID
HAVING
    total_count = 1;
```
**Query Execution Plan**

| Type |   Cost  |   Rows |
| --- | --- | --- |
| select | 18,294.43 | 28,207 |
