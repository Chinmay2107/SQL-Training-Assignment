**Query**: How many single-item orders were fulfilled from warehouses in the last month?<br>
<br>
**Solution**
```sql
SELECT
	oi.ORDER_ID,
	COUNT(oi.order_item_seq_id)
FROM
	Order_Header oh
JOIN Order_Item oi
		using (ORDER_ID)
JOIN Order_Status os on
	os.ORDER_ID = oh.ORDER_ID
	and os.ORDER_ITEM_SEQ_ID = oi.ORDER_ITEM_SEQ_ID
JOIN Facility f on
	f.facility_id = oh.origin_facility_id
WHERE
	os.status_datetime >= DATE_SUB(CURDATE(), interval 1 month)
	and os.status_datetime <= CURDATE()
	and f.facility_type_id = 'WAREHOUSE'
	and os.status_id = "ITEM_COMPLETED"
GROUP BY
	oi.ORDER_ID
HAVING
	COUNT(oi.order_item_seq_id)= 1;
```
**Query Execution Plan**

| Type |   Cost  |   Rows |
| --- | --- | --- |
| select | 18,294.43 | 28,207 |
