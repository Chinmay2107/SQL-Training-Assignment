**Query**: Fetch all the order items that are in the created status and the order type should be a sales order<br>
ORDER_ID<br>
PRODUCT_TYPE_ID<br>
ORDER_LINE_ID<br>
EXTERNAL_ID<br>
SALES_CHANNEL<br>
QUANTITY<br>
ITEM_STATUS <br>
PRODUCT_ID<br>
BILL_CITY<br>
BILL_COUNTRY<br>
BILL_POSTALCODE<br>
BILL_ADDRESS1<br>
BILL_ADDRESS2<br>
SHIP_CITY<br>
SHIP_COUNTRY<br>
SHIP_POSTALCODE<br>
SHIP_ADDRESS1<br>
SHIP_ADDRESS2<br>
<br>


**Solution**:
```sql
SELECT
    oi.ORDER_ID,
    p.PRODUCT_TYPE_ID,
    oi.ORDER_ITEM_SEQ_ID,
    oh.EXTERNAL_ID,
    oh.SALES_CHANNEL_ENUM_ID,
    oi.QUANTITY,
    oi.STATUS_ID AS ITEM_STATUS,
    oi.PRODUCT_ID,
    pb.CITY AS BILL_CITY,
    pb.COUNTRY_GEO_ID AS BILL_COUNTRY,
    pb.POSTAL_CODE AS BILL_POSTALCODE,
    pb.ADDRESS1 AS BILL_ADDRESS1,
    pb.ADDRESS2 AS BILL_ADDRESS2,
    ps.CITY AS SHIP_CITY,
    ps.COUNTRY_GEO_ID AS SHIP_COUNTRY,
    ps.POSTAL_CODE AS SHIP_POSTALCODE,
    ps.ADDRESS1 AS SHIP_ADDRESS1,
    ps.ADDRESS2 AS SHIP_ADDRESS2
FROM order_item oi
JOIN product p ON oi.PRODUCT_ID = p.PRODUCT_ID
JOIN order_status os ON oi.ORDER_ID = os.ORDER_ID AND oi.ORDER_ITEM_SEQ_ID = os.ORDER_ITEM_SEQ_ID AND os.STATUS_ID = oi.STATUS_ID
JOIN order_header oh ON oi.ORDER_ID = oh.ORDER_ID
JOIN order_contact_mech ocm ON oi.ORDER_ID = ocm.ORDER_ID AND (ocm.CONTACT_MECH_PURPOSE_TYPE_ID='BILLING_LOCATION' OR ocm.CONTACT_MECH_PURPOSE_TYPE_ID='SHIPPING_LOCATION')
LEFT JOIN postal_address pb ON ocm.CONTACT_MECH_ID = pb.CONTACT_MECH_ID AND ocm.CONTACT_MECH_PURPOSE_TYPE_ID = 'BILLING_LOCATION'
LEFT JOIN postal_address ps ON ocm.CONTACT_MECH_ID = ps.CONTACT_MECH_ID AND ocm.CONTACT_MECH_PURPOSE_TYPE_ID = 'SHIPPING_LOCATION'
WHERE
    os.STATUS_ID = 'ITEM_CREATED'
    AND oh.ORDER_TYPE_ID = 'SALES_ORDER';
```
**Query Execution Plan**

| Type   | Cost |   Rows |
|--------|------| --- |
| select |171,587.11 | 13359 |


